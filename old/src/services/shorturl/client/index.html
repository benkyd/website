<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Bens Amazing URL Shortener</title>
        <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
        <style>
            body {
                font-family: 'Raleway', sans-serif;
            }
            input {
                width: 200px;
            }
        </style>
    </head>
    <body>
        Place a URL in the box below for it to be shortened

        <br>
        <br>
        Url to shorten: <input type="text" id="smh" name="url"><br>
        <br>
        <input type="submit" id="submit" value="Submit">

        <br>
        <div id="url"></div>

        <script>
            let urlOutput = document.getElementById('url');
            let urlInput  = document.getElementById('smh');

            document.getElementById('submit').addEventListener('click', async (event) => {                

                let url = '/url';
                let data = { url: smh.value };

                let res = await fetch(url, {
                    method: 'POST',
                    body: JSON.stringify(data), 
                    headers:{
                        'Content-Type': 'application/json'
                    }
                })
                
                res = await res.json();

                url = res.url;

                if (url.startsWith('/')) {
                    url = window.location.protocol + '//' + window.location.hostname + url;
                    url = `<a herf=${url}>${url}</a>`;
                }

                urlOutput.innerHTML = url;
            });
        </script>

    </body>
</html>
